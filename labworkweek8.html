<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio for Music Curation and Analytics</title>
    <script type="text/javascript" src="https://www.x3dom.org/download/x3dom.js"></script>
    <link rel="stylesheet" type="text/css" href="https://www.x3dom.org/download/x3dom.css">
</head>
 
    <style>
       @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Playfair+Display:wght@700&display=swap');
	   
       /* General Styles */
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            overflow-x: hidden;
            font-family: 'Helvetica', sans-serif;
            background-color: #f4f4f4;
            color: #333;
			line-height: 1.6;

        }

        /* Header Styles */
        header {
            background-color: #1A2B4C;
            color: white;
            padding: 20px;
            text-align: center;
        }

        nav {
            margin-top: 15px;
        }

        nav a {
            font-family: 'Montserrat', sans-serif;
            color: white;
            margin: 0 20px;
            text-decoration: none;
            font-size: 1.2rem;
        }

        nav a:hover {
            color: #FF6F61;
        }
		
		nav {
    		display: flex;
    		justify-content: center;
    		align-items: center;
    		gap: 20px;
		}

		.dropdown {
    		position: relative;
    		display: inline-block;
		}

		.submenu {
    		display: none;
    		position: absolute;
    		top: 100%;
    		left: 50%; 
    		transform: translateX(-50%); 
    		background-color: #1A2B4C;
    		padding: 10px 0;
    		border-radius: 5px;
    		min-width: 150px;
    		text-align: left;
    		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    		z-index: 10;
		}

		.submenu li {
    		list-style: none;
		}

		.submenu li a {
    		display: block;
    		color: white;
    		text-decoration: none;
    		padding: 5px 10px;
    		font-family: 'Montserrat', sans-serif;
    		transition: background-color 0.3s;
		}

		.submenu li a:hover {
    		background-color: #FF6F61;
		}

		.dropdown:hover .submenu {
    display: block;
		}

		.dropdown:hover .submenu,
		.submenu:hover {
    		display: block;
		}

		.dropdown .submenu {
    margin-top: -1px;
		}


/* Hero Section */
		.hero {
    		background: linear-gradient(135deg, rgba(249, 216, 184, 0.8), rgba(224, 213, 193, 0.8), rgba(191, 193, 178, 0.8)), url('https://upload.wikimedia.org/wikipedia/commons/b/bf/Video_Game_Museum_in_Berlin_%2845033793755%29.jpg') center center/cover no-repeat;
    		height: 83vh;
    		width: 100vw;
			height: 80vh;
    		display: flex;
    		justify-content: center;
    		align-items: center;
    		color: white;
    		text-align: center;
    		position: relative;
    		box-sizing: border-box;
    		background-size: cover;
		}

        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
			color: Black;
        }

        .hero p {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3rem;
			margin: 0 auto 50px auto;
			color: Black;
        }

        .cta-btn {
            margin-top: 20px;
            padding: 15px 30px;
            font-size: 1.2rem;
            background-color: #FF6F61;
            color: white;
            border: none;
            border-radius: 25px;
            text-decoration: none;
            transition: background-color 0.3s;
			font-family: 'Montserrat', sans-serif;
        }

        .cta-btn:hover {
            background-color: #E05650;
        }

        /* Content Container */
        .container {
            width: 90%; 
            margin: auto;
            padding: 40px 0;
        }

        h1, h2 {
            font-family: 'Playfair Display', serif;
            color: #1A2B4C;
        }

        h1 {
            text-align: center;
            font-size: 3rem;
            margin-bottom: 30px;
        }

        h2 {
            font-size: 2rem;
            margin-bottom: 20px;
        }
     
		h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
			font-family: 'Montserrat', sans-serif;

        }

		h4 {
			font-size:1.3rem;
			margin-bottom:20px;
			font-family:'Montserrat', sans-serif;
			margin-top:20px
		}
			
        p, ul {
            font-size: 1.2rem;
            margin-bottom: 20px;
			font-family: 'Helvetica', sans-serif;

        }

        .section {
		margin-top: 20px; 
            margin-bottom: 40px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
		
		.task-image-block{
      		margin:16px auto 0;
      		max-width: min(1200px, 100%);    /* wider than old 820px */
    	}
    	
		.task-image-block img{
      		width:100%;
      		height:auto;
      		display:block;
      		border-radius:12px;
      		box-shadow:0 6px 18px rgba(0,0,0,.15);
      		cursor: zoom-in;             
    	}
    
		.task-image-block figcaption{
      		font-size:.95rem; color:#555; text-align:center; margin-top:8px;
    	}

   		 :root { --meta-col: 14rem; } 

   		 .meta-table {
      		width: 100%;
      		border-collapse: collapse;
      		table-layout: fixed;    
      		margin-top: 20px;
   		}
		
    	.meta-table col.meta   { width: var(--meta-col); }
    	.meta-table col.track  { width: calc((100% - var(--meta-col)) / 3); }

    	.meta-table th, .meta-table td {
      		padding: 10px;
      		border: 1px solid #ccc;
      		vertical-align: top;
    	}
		
    	.meta-table thead th {
      		background: #eee;
      		text-align: left;
   		}

	 	.zoom-modal{
      		position:fixed; inset:0;
      		background:rgba(0,0,0,.8);
      		display:none;                 
      		align-items:center; justify-content:center;
      		z-index:9999;
    	}
    
		.zoom-modal.open{ display:flex; }
    
		
		.zoom-stage{
      		position:relative;
      		width: min(95vw, 1600px);
      		height: min(90vh, 900px);
      		background:#111;
      		overflow:hidden;
      		border-radius:12px;
      		box-shadow:0 10px 30px rgba(0,0,0,.4);
      		touch-action:none;          
    	}
    
		.zoom-img{
      		position:absolute; top:50%; left:50%;
      		transform: translate(-50%,-50%) scale(1);
      		transform-origin: center center;
      		user-select:none; -webkit-user-drag:none; pointer-events:none;
      		max-width:none;              
    	}
		
    	.zoom-ui{
      		position:absolute; right:12px; bottom:12px; display:flex; gap:8px;
    	}
    	
		.zoom-btn{
      		background:rgba(128, 128, 128,.1);
      		color:#fff; border:1px solid rgba(255,255,255,.25);
      		padding:8px 12px; border-radius:8px; cursor:pointer; font-family:'Montserrat',sans-serif;
      		backdrop-filter: blur(6px);
    	}
		
    	.zoom-btn:hover{ background:rgba(128, 128, 128,.2); }

	/* Quick Links Section */
        .quick-links {
            background-color: #FCE0E3;
            padding: 50px 20px;
            text-align: center;
        }

        .quick-links h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: #333;
        }

        .quick-links .button {
            background-color: #FF6F61;
            color: white;
            padding: 15px 30px;
            margin: 10px;
            font-size: 1.2rem;
            border: none;
            border-radius: 25px;
            text-decoration: none;
            display: inline-block;
            transition: background-color 0.3s, transform 0.2s;
			font-family: 'Montserrat', sans-serif;
        }

        .quick-links .button:hover {
            background-color: #E05650;
            transform: scale(1.05);
        }
		

	/* Footer Section */
     footer {
            background-color: #1A2B4C;
            color: white;
            text-align: center;
            padding: 20px;
            position: relative;
            bottom: 0;
            width: 100%;
        }

        footer p {
            margin: 0;
            font-size: 1rem;
        }	
		
    </style>
</head>  
<body>

<!-- Header Section -->
    
<header>
    <nav>
        <a href="index.html">Home</a>
        <div class="dropdown">
            <a href="#" class="parent">Weekly Individual Labwork Tasks</a>
            <ul class="submenu">
                <li><a href="labworkweek1.html">Week 1</a></li>
                <li><a href="labworkweek2.html">Week 2</a></li>
                <li><a href="labworkweek3.html">Week 3</a></li>
                <li><a href="labworkweek4.html">Week 4</a></li>
				<li><a href="labworkweek5.html">Week 5</a></li>
				<li><a href="labworkweek6.html">Week 6</a></li>
				<li><a href="labworkweek7.html">Week 7</a></li>
				<li><a href="labworkweek8.html">Week 8</a></li>
				<li><a href="labworkweek9.html">Week 9</a></li>
				<li><a href="labworkweek10.html">Week 10</a></li>
            </ul>
        </div>
        <a href="reflection.html">Conclusion / Reflection</a>
    </nav>
</header>

<!-- Hero Section -->
   
<section class="hero">
    <div>
      <h1>Week 8 – Music as Sound</h1>
        <p>A brief look at music from the point of view of digital audio</p>
          <a href="#content" class="cta-btn">Scroll Down to Explore Week 8 IL Tasks</a>
    </div>
    </section>


<!-- Week 8 Content Section -->
<section id="content" class="container">

  <h1>Audio Analysis & Technical Metadata</h1>

  <div class="section">
    <p>
      This week focused on analysing music from the perspective of <strong>digital audio</strong>, with an emphasis on extracting technical metadata and generating visual 
      time–frequency representations of sound.
    </p>
    <p>
      For this activity, I selected three contrasting audio tracks from <em>The Legend of Zelda</em> franchise and performed waveform and spectrogram analysis 
      using <strong>SonicVisualizer</strong>.
    </p>
  </div>

  <div class="section">
    <h2>1. Audio Tracks & Metadata</h2>
  <p>
      To ensure stylistic diversity, I selected three contrasting pieces from the <em>Legend of Zelda</em> franchise. Below, each track includes:
    </p>

    <ul>
	  <li><strong>YouTube link</strong> for full OST version</li>
      <li><strong>Embedded MP3 playback</strong> (stored in my GitHub portfolio)</li>
      <li>Technical metadata</li>
    </ul>

    <h3>1.1 The Audio Tracks</h3>

    <h4>1. Gerudo Valley — Ocarina of Time (1998)</h4>
	<p>Latin-inspired orchestral cue with guitars and brass.</p>
	<p>YouTube:  
    	<a href="https://www.youtube.com/watch?v=0hEYvdMoF2g" target="_blank">
      	Gerudo Valley (OST) on YouTube.
    	</a>
    </p>
    <audio controls style="width:100%; margin-bottom:10px;">
      <source src="data/gerudo_valley.mp3" type="audio/mpeg">
    </audio>

    <h4>2. Midna’s Lament — Twilight Princess (2006)</h4>
	<p>Sombre, atmospheric piece for strings and piano.</p>
	<p>YouTube:  
    	<a href="https://www.youtube.com/watch?v=P_kyCU0gwfA" target="_blank">
        Midna’s Lament (OST) on YouTube.
    	</a>
    </p>
    <audio controls style="width:100%; margin-bottom:10px;">
      <source src="data/midnas_lament.mp3" type="audio/mpeg">
    </audio>

    <h4>3. Kakariko Village (Night) — Breath of the Wild (2017)</h4>
	<p>Gentle, folk-inspired piece featuring strings and warm flute melodies.</p>
	<p>YouTube:  
    	<a href="https://www.youtube.com/watch?v=RRtG3qz-Hjo" target="_blank">
        Kakariko Village - Night (OST) on YouTube.
    	</a>
    </p>
    <audio controls style="width:100%; margin-bottom:10px;">
      <source src="data/kakariko_village_night.mp3" type="audio/mpeg">
    </audio>
    
	<p>
      These tracks represent nearly three decades of the Zelda franchise’s musical evolution, showing how composers adapted to changing hardware and aesthetics.
    </p>


	<h3>1.2 Technical Metadata Table</h3>
    <p><em>List of the most important technical and non-technical metadata associated with each track.</em></p>

<table class="meta-table"; style="width:100%; border-collapse:collapse; margin-top:20px;">
  <colgroup>
    <col class="meta">
    <col class="track">
    <col class="track">
    <col class="track">
  </colgroup>
  <thead>
    <tr>
      <th></th>
      <th>Track 1: Gerudo Valley — Ocarina of Time (1998)</th>
      <th>Track 2: Midna’s Lament — Twilight Princess (2006)</th>
      <th>Track 3: Kakariko Village (Night) — Breath of the Wild (2017)</th>
    </tr>
  </thead>
	  <tbody>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Title</td>
        <td style="padding:10px; border:1px solid #ccc;">Gerudo Valley</td>
        <td style="padding:10px; border:1px solid #ccc;">Midna’s Lament</td>
        <td style="padding:10px; border:1px solid="#ccc;">Kakariko Village (Night)</td>
      </tr>
	  <tr>
        <td style="padding:10px; border:1px solid #ccc;">Artist</td>
        <td style="padding:10px; border:1px solid #ccc;">Koji Kondo</td>
        <td style="padding:10px; border:1px solid #ccc;">Koji, Kondo, Toru Minegishi, and Asuka Ota</td>
        <td style="padding:10px; border:1px solid #ccc;">Hajime Wakai, Manaka Kataoka, and Yasuaki Iwata</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Composer</td>
        <td style="padding:10px; border:1px solid #ccc;">Koji Kondo</td>
        <td style="padding:10px; border:1px solid #ccc;">Koji Kondo, Toru Minegishi, and Asuka Ota</td>
        <td style="padding:10px; border:1px solid #ccc;">Hajime Wakai, Manaka Kataoka, and Yasuaki Iwata</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Copyright info</td>
        <td style="padding:10px; border:1px solid #ccc;">Nintendo 1998</td>
        <td style="padding:10px; border:1px solid #ccc;">Nintendo 2006</td>
        <td style="padding:10px; border:1px solid #ccc;">Nintendo 2017</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Genre</td>
        <td style="padding:10px; border:1px solid #ccc;">Soundtrack</td>
        <td style="padding:10px; border:1px solid #ccc;">Soundtrack</td>
        <td style="padding:10px; border:1px solid #ccc;">Soundtrack</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Source</td>
        <td style="padding:10px; border:1px solid #ccc;"><a href="https://archive.org/details/tloz-oot-original-soundtrack" target="_blank">Interent Archive</a></td>
        <td style="padding:10px; border:1px solid #ccc;"><a href="https://www.youtube.com/watch?v=P_kyCU0gwfA" target="_blank">YouTube</a></td>
        <td style="padding:10px; border:1px solid #ccc;"><a href="https://www.youtube.com/watch?v=RRtG3qz-Hjo" target="_blank">YouTube</a></td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">File/audio format</td>
        <td style="padding:10px; border:1px solid #ccc;">Nintendo 64 Sequence files (.seq), Sound banks in .ctl and .tbl files containing VADPCM-compressed samples.</td>
        <td style="padding:10px; border:1px solid #ccc;">AST and AW files, which contain PCM16 (16-bit signed) sound data. </td>
        <td style="padding:10px; border:1px solid #ccc;">FLAC, WAV, or MP3.</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Number of channels</td>
        <td style="padding:10px; border:1px solid #ccc;">2 (Stereo)</td>
        <td style="padding:10px; border:1px solid #ccc;">2 (Stereo)</td>
        <td style="padding:10px; border:1px solid #ccc;">2 (Stereo)</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Sample Rate</td>
        <td style="padding:10px; border:1px solid #ccc;">44.1 kHz</td>
        <td style="padding:10px; border:1px solid #ccc;">48 kHz</td>
        <td style="padding:10px; border:1px solid #ccc;">48 kHz</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Bits per second</td>
        <td style="padding:10px; border:1px solid #ccc;">1411.2 kbps</td>
        <td style="padding:10px; border:1px solid #ccc;">2304 kbps</td>
        <td style="padding:10px; border:1px solid #ccc;">2304 kbps</td>
      </tr>
      <tr>
        <td style="padding:10px; border:1px solid #ccc;">Duration</td>
        <td style="padding:10px; border:1px solid #ccc;">2:56</td>
        <td style="padding:10px; border:1px solid #ccc;">3:08</td>
        <td style="padding:10px; border:1px solid #ccc;">4:32</td>
      </tr>
	  </tbody>
    </table>	  
  </div>

  <div class="section">
    <h2>2. Sonic Visualizer Analysis</h2>
    <p>
      For each track, I produced two visualisations in Sonic Visualizer:
    </p>
    <ul>
      <li><strong>Waveform</strong> — amplitude over time</li>
      <li><strong>Spectrogram</strong> — frequency over time</li>
    </ul>
    <p>These images were exported as PNG files and uploaded to my GitHub repository.</p>

    <h3>2.1 Gerudo Valley</h3>
  	<figure class="task-image-block full-bleed">
    	<img class="zoomable" src="data/week8_gerudo_waveform.png" alt="Gerudo Valley waveform">
    	<figcaption>Gerudo Valley — Waveform</figcaption>
  	</figure>
  	<figure class="task-image-block full-bleed">
    	<img class="zoomable" src="data/week8_gerudo_spectrogram.png" alt="Gerudo Valley spectrogram">
    	<figcaption>Gerudo Valley — Spectrogram</figcaption>
  	</figure>

    <h3>2.2 Midna’s Lament</h3>
 	<figure class="task-image-block full-bleed">
    	<img class="zoomable" src="data/week8_midna_waveform.png" alt="Midna’s Lament waveform">
    	<figcaption>Midna’s Lament — Waveform</figcaption>
  	</figure>
  	<figure class="task-image-block full-bleed">
    	<img class="zoomable" src="data/week8_midna_spectrogram.png" alt="Midna’s Lament spectrogram">
    	<figcaption>Midna’s Lament — Spectrogram</figcaption>
  	</figure>

    <h3>2.3 Hateno Village (Day)</h3>
  	<figure class="task-image-block full-bleed">
    	<img class="zoomable" src="data/week8_kakariko_waveform.png" alt="Kakariko Village (Night) waveform">
    	<figcaption>Kakariko Village (Night) — Waveform</figcaption>
  	</figure>
  	<figure class="task-image-block full-bleed">
    	<img class="zoomable" src="data/week8_kakariko_spectrogram.png" alt="Kakariko Village (Night) spectrogram">
    	<figcaption>Kakariko Village (Night) — Spectrogram</figcaption>
  	</figure>

	<div id="zoomModal" class="zoom-modal" aria-hidden="true">
  		<div class="zoom-stage" role="dialog" aria-modal="true" aria-label="Zoomed image viewer">
    	<img id="zoomImg" class="zoom-img" alt="">
    <div class="zoom-ui">
      <button id="zoomOutBtn" class="zoom-btn" type="button">−</button>
      <button id="zoomResetBtn" class="zoom-btn" type="button">Reset</button>
      <button id="zoomInBtn" class="zoom-btn" type="button">+</button>
      <button id="zoomCloseBtn" class="zoom-btn" type="button">Close</button>
    </div>
  </div>
</div>

  </div>

	

<!-- Quick Links to Weekly Analysis -->
	
    <section class="quick-links">
        <h2>Click the link below to continue exploring the portfolio</h2>
        <a href="labworkweek9.html" class="button"> Week 9 IL Tasks</a>
    </section>

<!-- Footer Section -->

    <footer>
        <p>&copy; 2025 Portfolio for Music Curation and Analytics - Koji Kondo in The Legend of Zelda video game franchise. 
			2742018. All rights reserved.</p>
    </footer>


<script>
  (function(){
    const modal   = document.getElementById('zoomModal');
    const stage   = modal.querySelector('.zoom-stage');
    const img     = document.getElementById('zoomImg');
    const btnIn   = document.getElementById('zoomInBtn');
    const btnOut  = document.getElementById('zoomOutBtn');
    const btnReset= document.getElementById('zoomResetBtn');
    const btnClose= document.getElementById('zoomCloseBtn');

    const Z_MIN = 1, Z_MAX = 6, STEP = 0.2;
    let scale = 1, tx = 0, ty = 0;   
    let startX=0, startY=0, dragging=false;

    function openModal(src, alt){
      img.src = src; img.alt = alt || '';
      scale = 1; tx = 0; ty = 0;
      applyTransform();
      modal.classList.add('open');
      modal.setAttribute('aria-hidden', 'false');
      requestAnimationFrame(fitToStage);
    }

    function closeModal(){
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden', 'true');
      img.src = '';
    }

    function applyTransform(){
      img.style.transform = `translate(calc(-50% + ${tx}px), calc(-50% + ${ty}px)) scale(${scale})`;
    }

    function fitToStage(){
      if (!img.naturalWidth) return;
      const sw = stage.clientWidth, sh = stage.clientHeight;
      const iw = img.naturalWidth, ih = img.naturalHeight;
      const fit = Math.min(sw/iw, sh/ih);
      scale = Math.max(Z_MIN, fit); tx = 0; ty = 0; applyTransform();
    }

    function clampPan(){
      const sw = stage.clientWidth, sh = stage.clientHeight;
      const iw = img.naturalWidth * scale, ih = img.naturalHeight * scale;
      const maxX = Math.max(0, (iw - sw)/2), maxY = Math.max(0, (ih - sh)/2);
      tx = Math.min(maxX, Math.max(-maxX, tx));
      ty = Math.min(maxY, Math.max(-maxY, ty));
    }

    function zoomAt(clientX, clientY, delta){
      const rect = stage.getBoundingClientRect();
      const cx = clientX - rect.left - rect.width/2 - tx;
      const cy = clientY - rect.top  - rect.height/2 - ty;
      const prev = scale;
      scale = Math.min(Z_MAX, Math.max(Z_MIN, scale * (delta>0 ? (1+STEP) : (1-STEP))));
      const k = (scale/prev) - 1;
      tx -= cx * k; ty -= cy * k;
      clampPan(); applyTransform();
    }

    document.querySelectorAll('img.zoomable').forEach(el=>{
      el.addEventListener('click', ()=> openModal(el.getAttribute('data-zoom-src') || el.src, el.alt));
    });

    function onDown(e){
      dragging = true;
      const p = e.touches ? e.touches[0] : e;
      startX = p.clientX - tx; startY = p.clientY - ty;
    }
    function onMove(e){
      if(!dragging) return;
      const p = e.touches ? e.touches[0] : e;
      tx = p.clientX - startX; ty = p.clientY - startY;
      clampPan(); applyTransform();
    }
    function onUp(){ dragging=false; }

    stage.addEventListener('mousedown', onDown);
    window.addEventListener('mousemove', onMove);
    window.addEventListener('mouseup', onUp);
    stage.addEventListener('touchstart', onDown, {passive:false});
    stage.addEventListener('touchmove', onMove, {passive:false});
    stage.addEventListener('touchend', onUp);

    stage.addEventListener('wheel', (e)=>{
      e.preventDefault();
      zoomAt(e.clientX, e.clientY, e.deltaY < 0 ? +1 : -1);
    }, {passive:false});

    btnIn.addEventListener('click', ()=> zoomAt(stage.getBoundingClientRect().left + stage.clientWidth/2, stage.getBoundingClientRect().top + stage.clientHeight/2, +1));
    btnOut.addEventListener('click',()=> zoomAt(stage.getBoundingClientRect().left + stage.clientWidth/2, stage.getBoundingClientRect().top + stage.clientHeight/2, -1));
    btnReset.addEventListener('click', fitToStage);
    btnClose.addEventListener('click', closeModal);

    modal.addEventListener('click', (e)=>{ if(e.target === modal) closeModal(); });
    window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeModal(); });
    stage.addEventListener('dblclick', (e)=>{
      e.preventDefault();
      const targetScale = (scale <= 1.5) ? 2 : 1;
      const direction = (targetScale > scale) ? +1 : -1;
      scale = targetScale; applyTransform();
      zoomAt(e.clientX, e.clientY, direction);
    });
    window.addEventListener('resize', ()=> { if(modal.classList.contains('open')) fitToStage(); });
  })();
</script>

</body>
</html>
